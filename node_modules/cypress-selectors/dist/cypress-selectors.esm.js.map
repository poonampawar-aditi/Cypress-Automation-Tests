{"version":3,"file":"cypress-selectors.esm.js","sources":["../src/Logger.ts","../src/InternalSymbols.ts","../src/utils.ts","../src/ConfigureSelectors.ts","../src/SelectorBuilder.ts","../src/Validators.ts","../src/XPath.ts","../src/Selectors.ts"],"sourcesContent":["type LogLevel = 'info' | 'warning' | 'error';\n\nconst Logger = {\n  LOG_PREFIX: `[cypress-selectors]`,\n\n  logSelector: (selector: string, propertyPath: string, level: LogLevel = 'info'): void =>\n    Logger.log(`Querying \"${propertyPath}\" by selector: ${selector}`, level),\n\n  appendLogPrefix: (message: string): string => `${Logger.LOG_PREFIX} ${message}`,\n\n  log: (message: string, level: LogLevel): void => {\n    const formattedMsg = `${Logger.LOG_PREFIX} ${message}`;\n\n    if (level === 'info') return console.info(formattedMsg);\n    else if (level === 'warning') return console.warn(formattedMsg);\n    else if (level === 'error') return console.error(formattedMsg);\n    else console.log(formattedMsg);\n\n    const _: never = level; // eslint-disable-line @typescript-eslint/no-unused-vars\n  },\n};\n\nexport { Logger };\n","const internalAliasKey: unique symbol = Symbol('INTERNAL_ALIAS_KEY');\nconst hostIDKey: unique symbol = Symbol('HOST_ID');\nconst byExternalAlias: unique symbol = Symbol('SELECTORS_BY_EXTERNAL_ALIAS_STORAGE');\nconst byInternalAlias: unique symbol = Symbol('SELECTORS_BY_INTERNAL_ALIAS_STORAGE');\n\nexport { internalAliasKey, hostIDKey, byExternalAlias, byInternalAlias };\n","import { Logger } from './Logger';\nimport { hostIDKey } from './InternalSymbols';\nimport type { Host, EnvWithSelectorsStorage, SelectorType } from './SelectorBuilder';\n\ntype ExceptionKind =\n  | 'INTERNAL ERROR'\n  | 'CONFIGURATION ERROR'\n  | 'NON CONFIGURABLE FIELD'\n  | 'DUPLICATE ALIAS'\n  | 'NO SUCH ALIAS'\n  | 'ENVIRONMENT ERROR';\n\nconst buildException = (message: string, kind: ExceptionKind = 'INTERNAL ERROR'): Error =>\n  new Error(Logger.appendLogPrefix(`Error type: ${kind}, message: ${message}`));\n\nconst isConfigurableProperty = (host: Host, name: string): boolean => {\n  const descriptor = Object.getOwnPropertyDescriptor(host, name);\n  return descriptor ? Boolean(descriptor.configurable) : true;\n};\n\nconst makeDisplayPropName = (host: Host, property: string): string => `${host.name}.${property}`;\nconst makeInternalAlias = (hostID: number, alias: string): string =>\n  `host-id: ${hostID}, internal-alias: ${alias}`;\n\nconst registerAndAssignNewHostId = (env: EnvWithSelectorsStorage, host: Host): number => {\n  const hostID = (env[hostIDKey] ?? 0) + 1;\n  env[hostIDKey] = hostID;\n  host[hostIDKey] = hostID;\n\n  return hostID;\n};\n\nconst getHostIdFromHost = (host: Host): number | undefined => host[hostIDKey];\nconst TRANSLATE_TO_LOWER_CASE_XPATH_FN = `translate(text(), 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')`;\n\nconst escapeQuoteSymbols = (query: string): string => {\n  const escaped = [query]\n    .flatMap(inclusiveSplitByDoubleQuote)\n    .flatMap(inclusiveSplitBySingleQuote)\n    .flatMap(inclusiveSplitByBackTick)\n    .map(wrapQuoteSymbol);\n\n  return escaped.length === 1 ? escaped[0] : `concat(${escaped.join(', ')})`;\n};\n\nconst inclusiveSplitByDoubleQuote = (w: string) => w.split(/(?=[\",])|(?<=[\"])/g);\nconst inclusiveSplitBySingleQuote = (w: string) => w.split(/(?=[',])|(?<=['])/g);\nconst inclusiveSplitByBackTick = (w: string) => w.split(/(?=[`,])|(?<=[`])/g);\n\nconst wrapQuoteSymbol = (symbol: string): string => {\n  if (symbol === `'`) return `\"'\"`;\n  if (symbol === '\"') return `'\"'`;\n  if (symbol === '`') return '\"`\"';\n  else return `'${symbol}'`;\n};\n\nconst mapSelectorTypeToDisplaySelectorName = (type: SelectorType): string => {\n  if (type === 'attribute') return 'ByAttribute';\n  else if (type === 'class') return 'ByClass';\n  else if (type === 'id') return 'ById';\n  else if (type === 'type') return 'ByType';\n  else if (type === 'selector') return 'BySelector';\n  else if (type === 'xpath') return 'ByXPath';\n  else if (type === 'name') return 'ByName';\n  else if (type === 'exact-text') return 'ByExactText';\n  else if (type === 'partial-text') return 'ByPartialText';\n  else if (type === 'exact-link-text') return `ByExactLinkText`;\n  else if (type === 'partial-link-text') return `ByPartialLinkText`;\n  else {\n    const _: never = type; // eslint-disable-line @typescript-eslint/no-unused-vars\n    throw buildException(`Unsupported selector type: ${type}`, 'INTERNAL ERROR');\n  }\n};\n\nexport {\n  buildException,\n  isConfigurableProperty,\n  makeDisplayPropName,\n  makeInternalAlias,\n  registerAndAssignNewHostId,\n  getHostIdFromHost,\n  escapeQuoteSymbols,\n  mapSelectorTypeToDisplaySelectorName,\n  TRANSLATE_TO_LOWER_CASE_XPATH_FN,\n};\n","const DEFAULT_ATTRIBUTE = 'cypress-id';\nconst DEFAULT_LOGGING = false;\nconst DEFAULT_SEARCH_ONLY_FIRST_LEVEL_DESCENDANTS = false;\n\nconst DEFAULT_CONFIG = {\n  defaultAttribute: DEFAULT_ATTRIBUTE,\n  isLoggingEnabled: DEFAULT_LOGGING,\n  searchOnlyFirstLevelDescendants: DEFAULT_SEARCH_ONLY_FIRST_LEVEL_DESCENDANTS,\n};\n\ntype Configuration = {\n  defaultAttribute: string;\n  isLoggingEnabled: boolean;\n  searchOnlyFirstLevelDescendants: boolean;\n};\n\nconst CONFIG_HANDLER = {\n  reset: (): Configuration => (CONFIG_HANDLER.config = { ...DEFAULT_CONFIG }),\n  configure: ({\n    defaultAttribute = DEFAULT_ATTRIBUTE,\n    isLoggingEnabled = DEFAULT_LOGGING,\n    searchOnlyFirstLevelDescendants = DEFAULT_SEARCH_ONLY_FIRST_LEVEL_DESCENDANTS,\n  }: Partial<Configuration>): Configuration => {\n    const { config } = CONFIG_HANDLER;\n    config.defaultAttribute = defaultAttribute;\n    config.isLoggingEnabled = isLoggingEnabled;\n    config.searchOnlyFirstLevelDescendants = searchOnlyFirstLevelDescendants;\n\n    return config;\n  },\n  config: { ...DEFAULT_CONFIG },\n};\n\nconst ConfigureSelectors = CONFIG_HANDLER.configure;\nconst ResetSelectorsConfiguration = CONFIG_HANDLER.reset;\n\nconst getConfiguration = (): typeof CONFIG_HANDLER['config'] => ({ ...CONFIG_HANDLER.config });\n\nexport { ConfigureSelectors, getConfiguration, ResetSelectorsConfiguration };\nexport type { Configuration };\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { max } from 'lodash';\nimport { buildException, isConfigurableProperty, makeDisplayPropName } from './utils';\nimport { getConfiguration } from './ConfigureSelectors';\nimport { internalAliasKey, hostIDKey, byExternalAlias, byInternalAlias } from './InternalSymbols';\nimport { Logger } from './Logger';\nimport { TRANSLATE_TO_LOWER_CASE_XPATH_FN, escapeQuoteSymbols } from './utils';\n\nimport type { Configuration } from './ConfigureSelectors';\n\ntype InternalSelectorConfig = {\n  value: string;\n  alias?: string;\n  internalAlias: string;\n  parentAlias?: string;\n  internalParentAlias?: string;\n  attribute?: string;\n  eq?: number;\n  timeout?: number;\n  ignoreCase?: boolean;\n};\ntype SelectorType =\n  | 'attribute'\n  | 'id'\n  | 'class'\n  | 'type'\n  | 'selector'\n  | 'xpath'\n  | 'exact-text'\n  | 'partial-text'\n  | 'name'\n  | 'exact-link-text'\n  | 'partial-link-text';\n\ntype SelectorMeta = { host: Host; property: string; hostID: number };\n\ntype Selector = {\n  config: InternalSelectorConfig;\n  type: SelectorType;\n  meta: SelectorMeta;\n  engine: SelectorsEngine;\n};\n\ntype SelectorsStorage = Map<string, Selector>;\n\ntype Storages = {\n  selectorsByInternalAlias: SelectorsStorage;\n  selectorsByExternalAlias: SelectorsStorage;\n};\n\ntype Host = {\n  [key: string]: Selector | any;\n  [hostIDKey]?: number;\n  [byExternalAlias]?: SelectorsStorage;\n};\ntype SelectorProxy = {\n  [internalAliasKey]?: string;\n};\n\ntype Env = Cypress.cy;\n\ntype EnvWithSelectorsStorage = Env & {\n  [byInternalAlias]: SelectorsStorage;\n  [hostIDKey]: number;\n};\ntype SelectorsByEngine =\n  | { engine: 'CSS'; selectors: Array<Selector> }\n  | { engine: 'XPath'; selector: Selector };\ntype SelectorsEngine = SelectorsByEngine['engine'];\n\nconst buildSelector = (selector: Selector, env: Env): any => {\n  const { host, property } = selector.meta;\n  const { selectorsByInternalAlias } = registerStoragesAndSelector(selector, env);\n\n  const elementGetter = generateElementGetter(selectorsByInternalAlias, selector);\n\n  if (isConfigurableProperty(host, property)) {\n    const selectorProxy = generateSelectorProxy(elementGetter);\n    assignInternalAliasToProxy(selectorProxy, selector.config.internalAlias);\n\n    delete host[property];\n    const descriptor = { enumerable: false, configurable: false, value: selectorProxy };\n    return Object.defineProperty(host, property, descriptor);\n  }\n\n  const displayProp = makeDisplayPropName(host, property);\n  throw buildException(\n    `Failed to assign selector - property \"${displayProp}\" is not 'configurable'`,\n    'NON CONFIGURABLE FIELD',\n  );\n};\n\nconst generateSelectorProxy = (getChainer: () => Cypress.Chainable<any>) => {\n  const proxyAccessHandler = (proxy: SelectorProxy, field: string | symbol) => {\n    if (typeof field === 'symbol' && internalAliasKey === field) return proxy[internalAliasKey];\n\n    const chainer = getChainer();\n    const value = chainer[field as keyof typeof chainer];\n    return typeof value === 'function' ? value.bind(chainer) : value;\n  };\n\n  return new Proxy({}, { get: proxyAccessHandler });\n};\n\nconst assignInternalAliasToProxy = (selectorProxy: SelectorProxy, internalAlias: string) =>\n  (selectorProxy[internalAliasKey] = internalAlias);\n\nconst registerStoragesAndSelector = (selector: Selector, env: Env): Storages => {\n  const selectorsByInternalAlias = registerSelectorsByInternalAliasStorageIfNotRegistered(env);\n  registerSelectorByInternalAlias(selector, selectorsByInternalAlias);\n\n  const { host } = selector.meta;\n  const selectorsByExternalAlias = registerSelectorByExternalAliasStorageIfNotRegistered(host);\n\n  if (selector.config.alias)\n    registerSelectorByExternalAlias(selector, selector.config.alias, selectorsByExternalAlias);\n\n  return { selectorsByInternalAlias, selectorsByExternalAlias };\n};\n\nconst registerSelectorsByInternalAliasStorageIfNotRegistered = (env: Env): SelectorsStorage => {\n  if (hasSelectorsStorage(env) === false) {\n    (env as EnvWithSelectorsStorage)[byInternalAlias] = new Map();\n  }\n\n  return (env as EnvWithSelectorsStorage)[byInternalAlias];\n};\n\nconst hasSelectorsStorage = (env: Env): boolean => env.hasOwnProperty(byInternalAlias);\n\nconst registerSelectorByInternalAlias = (selector: Selector, storage: SelectorsStorage) => {\n  const { internalAlias } = selector.config;\n\n  if (storage.has(internalAlias))\n    throw buildException(\n      `Element with the internal-alias \"${internalAlias}\" is already registered.`,\n      'DUPLICATE ALIAS',\n    );\n\n  return storage.set(internalAlias, selector);\n};\n\nconst registerSelectorByExternalAlias = (\n  selector: Selector,\n  alias: string,\n  storage: SelectorsStorage,\n) => {\n  if (storage.has(alias))\n    throw buildException(\n      `Element with the alias \"${alias}\" is already registered.`,\n      'DUPLICATE ALIAS',\n    );\n\n  return storage.set(alias, selector);\n};\n\nconst registerSelectorByExternalAliasStorageIfNotRegistered = (host: Host): SelectorsStorage =>\n  host[byExternalAlias]\n    ? (host[byExternalAlias] as Map<string, Selector>)\n    : (host[byExternalAlias] = new Map<string, Selector>());\n\nconst getStorageOfExternalAliases = (host: Host): SelectorsStorage =>\n  host[byExternalAlias] as SelectorsStorage;\n\nconst generateElementGetter = (byInternalAlias: SelectorsStorage, selector: Selector) => () => {\n  const configuration = getConfiguration();\n\n  if (configuration.isLoggingEnabled) {\n    Logger.logSelector(\n      mapSelectorByType(selector, configuration),\n      makeDisplayPropName(selector.meta.host, selector.meta.property),\n    );\n  }\n\n  const chainOfSelectors = collectSelectorsChain(byInternalAlias, selector);\n  return mapSelectorConfigsToSelectorsChain(chainOfSelectors, configuration);\n};\n\nconst collectSelectorsChain = (\n  byInternalAlias: SelectorsStorage,\n  selector: Selector,\n  selectorsChain: Array<Selector> = [],\n): Array<Selector> => {\n  selectorsChain = [selector, ...selectorsChain];\n  const { parentAlias, internalParentAlias } = selector.config;\n\n  if (parentAlias) {\n    const byExternalAlias = getStorageOfExternalAliases(selector.meta.host);\n    const nextSelector = getSelectorByAliasOrThrow(byExternalAlias, parentAlias);\n    return collectSelectorsChain(byInternalAlias, nextSelector, selectorsChain);\n  } else if (internalParentAlias) {\n    const nextSelector = getSelectorByAliasOrThrow(byInternalAlias, internalParentAlias);\n    return collectSelectorsChain(byInternalAlias, nextSelector, selectorsChain);\n  }\n  return selectorsChain;\n};\n\nconst getSelectorByAliasOrThrow = (storage: SelectorsStorage, alias: string) => {\n  if (storage.has(alias)) return storage.get(alias) as Selector;\n  else\n    throw buildException(\n      `Failed to retrieve parent selector by \"${alias}\" alias.`,\n      'NO SUCH ALIAS',\n    );\n};\n\nconst ANY_LEVEL_DESCENDANT = ' ';\nconst FIRST_LEVEL_DESCENDANT = '>';\n\nconst mapSelectorConfigsToSelectorString = (\n  selectors: Array<Selector>,\n  configuration: Configuration,\n): string => {\n  const mappedSelectors: Array<string> = selectors.map((selector) =>\n    mapSelectorToString(selector, configuration),\n  );\n\n  const descendance = configuration.searchOnlyFirstLevelDescendants\n    ? FIRST_LEVEL_DESCENDANT\n    : ANY_LEVEL_DESCENDANT;\n\n  return mappedSelectors.join(descendance);\n};\n\nconst mapSelectorConfigsToSelectorsChain = (\n  selectors: Array<Selector>,\n  configuration: Configuration,\n): Cypress.Chainable => {\n  const mappedSelectors = mapSelectorsByType(\n    groupSelectorsByEngineSequentially(selectors),\n    configuration,\n  );\n\n  return mappedSelectors.reduce((chain, selector, index) => {\n    const options = { timeout: selector.timeout };\n\n    if (selector.engine === 'XPath') {\n      const { eq } = selector;\n\n      chain =\n        typeof eq === 'number'\n          ? (chain as any)\n              .__cypress_selectors_xpath(selector.selector, options, selector.type)\n              .eq(eq)\n          : (chain as any).__cypress_selectors_xpath(selector.selector, options, selector.type);\n    } else {\n      const isFirstInChain = 0 === index;\n\n      chain = isFirstInChain\n        ? chain.get(selector.selector, options)\n        : chain.find(selector.selector, options);\n    }\n\n    return chain;\n  }, cy as Cypress.Chainable);\n};\n\nconst mapSelectorsByType = (\n  groupedByEngine: Array<SelectorsByEngine>,\n  configuration: Configuration,\n): Array<\n  | { engine: 'CSS'; selector: string; timeout: number }\n  | {\n      engine: 'XPath';\n      selector: string;\n      timeout: number;\n      type: SelectorType;\n      eq: number | undefined;\n    }\n> => {\n  return groupedByEngine.map((group) =>\n    group.engine === 'XPath'\n      ? {\n          engine: 'XPath' as const,\n          selector: mapSelectorConfigsToSelectorString([group.selector], configuration),\n          timeout: group.selector.config.timeout ?? Cypress.config().defaultCommandTimeout,\n          type: group.selector.type,\n          eq: group.selector.config.eq,\n        }\n      : {\n          engine: 'CSS' as const,\n          selector: mapSelectorConfigsToSelectorString(group.selectors, configuration),\n          timeout: getMaxTimeout(group.selectors),\n        },\n  );\n};\n\nconst getMaxTimeout = (selectors: Array<Selector>): number => {\n  const { defaultCommandTimeout } = Cypress.config();\n  return max(selectors.map(({ config }) => config.timeout ?? defaultCommandTimeout)) as number;\n};\n\nconst groupSelectorsByEngineSequentially = (\n  selectors: Array<Selector>,\n): Array<SelectorsByEngine> => {\n  const result = [];\n  let chunk = [];\n\n  for (const selector of selectors) {\n    if (selector.engine === 'XPath') {\n      if (chunk.length === 0) result.push([selector]);\n      else {\n        result.push(chunk, [selector]);\n        chunk = [];\n      }\n    } else chunk.push(selector);\n  }\n  if (chunk.length) result.push(chunk);\n\n  return result.map((selectors) =>\n    selectors[0].engine === 'XPath'\n      ? { engine: 'XPath', selector: selectors[0] }\n      : { engine: 'CSS', selectors },\n  );\n};\n\nconst mapSelectorToString = (selector: Selector, configuration: Configuration): string => {\n  const stringifiedSelector = mapSelectorByType(selector, configuration);\n\n  const { eq } = selector.config;\n  return typeof eq === 'number' && selector.engine === 'CSS'\n    ? `${stringifiedSelector}:eq(${eq})`\n    : stringifiedSelector;\n};\n\nconst mapSelectorByType = (selector: Selector, configuration: Configuration) => {\n  const { type, config } = selector;\n  const { value, attribute } = config;\n\n  if (type === 'attribute') return `[${attribute ?? configuration.defaultAttribute}=\"${value}\"]`;\n  else if (type === 'class') return `.${value}`;\n  else if (type === 'id') return `#${value}`;\n  else if (type === 'type') return `${value}`;\n  else if (type === 'selector') return value;\n  else if (type === 'xpath') return value;\n  else if (type === 'name') return `[name=\"${value}\"]`;\n  else if (type === 'exact-text') return mapExactTextSelector(selector);\n  else if (type === 'partial-text') return mapPartialTextSelector(selector);\n  else if (type === 'exact-link-text') return mapExactTextSelector(selector, 'a');\n  else if (type === 'partial-link-text') return mapPartialTextSelector(selector, 'a');\n  else {\n    const _: never = type; // eslint-disable-line @typescript-eslint/no-unused-vars\n    throw buildException(`Unsupported selector type: ${type}`, 'INTERNAL ERROR');\n  }\n};\n\nconst mapExactTextSelector = (selector: Selector, forTag = '*'): string => {\n  const prefix = hasParent(selector) ? `./${forTag}` : `//${forTag}`;\n  const { value, ignoreCase } = selector.config;\n\n  const escaped = escapeQuoteSymbols(value);\n\n  return ignoreCase === true\n    ? `${prefix}[${TRANSLATE_TO_LOWER_CASE_XPATH_FN}=${escaped.toLowerCase()}]`\n    : `${prefix}[text()=${escaped}]`;\n};\n\nconst mapPartialTextSelector = (selector: Selector, forTag = '*'): string => {\n  const prefix = hasParent(selector) ? `./${forTag}` : `//${forTag}`;\n  const { value, ignoreCase } = selector.config;\n  const escaped = escapeQuoteSymbols(value);\n\n  return ignoreCase === true\n    ? `${prefix}[contains(${TRANSLATE_TO_LOWER_CASE_XPATH_FN}, ${escaped.toLowerCase()})]`\n    : `${prefix}[contains(text(), ${escaped})]`;\n};\n\nconst hasParent = ({ config: { parentAlias, internalParentAlias } }: Selector): boolean =>\n  parentAlias !== undefined || internalParentAlias !== undefined;\n\nexport { buildSelector, collectSelectorsChain, groupSelectorsByEngineSequentially };\nexport type {\n  Host,\n  Selector,\n  SelectorType,\n  SelectorMeta,\n  EnvWithSelectorsStorage,\n  InternalSelectorConfig,\n  SelectorsEngine,\n};\n","import { flow } from 'lodash';\nimport { Logger } from './Logger';\nimport { internalAliasKey } from './InternalSymbols';\nimport { buildException, mapSelectorTypeToDisplaySelectorName } from './utils';\nimport type { ExternalSelectorConfig } from './Selectors';\nimport type { SelectorType } from 'SelectorBuilder';\n\nconst SUPPORT_IGNORE_CASE_CONFIGURATION: Array<SelectorType> = [\n  'partial-text',\n  'exact-text',\n  'exact-link-text',\n  'partial-link-text',\n];\n\nconst SUPPORT_ATTRIBUTE_CONFIGURATION: Array<SelectorType> = ['attribute'];\n\nconst throwIfNotRunningInCypressEnv = (): void | never => {\n  if (!cy || typeof cy.get !== 'function')\n    throw buildException(\n      `Can't find \\`cy.get\\` function. Probably you're defining selectors outside of Cypress context. Please make sure, that you're querying elements inside Cypress tests.`,\n      'ENVIRONMENT ERROR',\n    );\n};\ntype ExtConfigWithDisplayProp = {\n  externalConfig: ExternalSelectorConfig;\n  displayProperty: string;\n  type: SelectorType;\n};\n\ntype Validator = (input: ExtConfigWithDisplayProp) => ExtConfigWithDisplayProp;\n\nconst validate = (\n  externalConfig: ExternalSelectorConfig,\n  displayProperty: string,\n  type: SelectorType,\n): ExternalSelectorConfig => {\n  const validate: Validator = flow(\n    shouldNotProvideBothParentAndParentAlias,\n    shouldNotProvideEmptyAlias,\n    shouldNotProvideEmptyParentAlias,\n    shouldNotProvideEmptyCustomAttribute,\n    shouldNotProvideNegativeEqAttribute,\n    shouldNotProvideNegativeTimeout,\n    shouldProvideParentDefinedOnlyViaCypressSelectors,\n    shouldNotProvideIgnoreCaseForNonTextSelectors,\n    shouldNotProvideAttributeConfigForSelectorsThatDoNotSupportIt,\n  );\n\n  const { externalConfig: sanitizedConfig } = validate({ externalConfig, displayProperty, type });\n  return sanitizedConfig;\n};\n\nconst shouldHaveType = (\n  attribute: keyof ExternalSelectorConfig,\n  { externalConfig, displayProperty }: ExtConfigWithDisplayProp,\n  expectedType: string,\n): ExternalSelectorConfig => {\n  const actualType = typeof externalConfig[attribute];\n\n  if (attribute in externalConfig && actualType !== expectedType) {\n    warnAboutTypeMismatch(displayProperty, attribute, expectedType, actualType);\n    delete externalConfig[attribute];\n  }\n\n  return externalConfig;\n};\n\nconst shouldNotProvideBothParentAndParentAlias = ({\n  externalConfig,\n  type,\n  displayProperty,\n}: ExtConfigWithDisplayProp): ExtConfigWithDisplayProp => {\n  externalConfig = shouldHaveType(\n    'parentAlias',\n    { externalConfig, displayProperty, type },\n    'string',\n  );\n\n  if (\n    typeof externalConfig.parent !== 'undefined' &&\n    typeof externalConfig.parentAlias === 'string'\n  ) {\n    warnAboutSupplyingParentAndParentAlias(displayProperty);\n\n    delete externalConfig['parentAlias'];\n  }\n  return { externalConfig, displayProperty, type };\n};\n\nconst shouldNotProvideEmptyAlias = ({\n  externalConfig,\n  type,\n  displayProperty,\n}: ExtConfigWithDisplayProp): ExtConfigWithDisplayProp => {\n  externalConfig = shouldHaveType('alias', { externalConfig, displayProperty, type }, 'string');\n\n  if (typeof externalConfig.alias === 'string' && externalConfig.alias.length === 0) {\n    warnAboutEmptyAlias(displayProperty);\n    delete externalConfig['alias'];\n  }\n\n  return { externalConfig, displayProperty, type };\n};\n\nconst shouldNotProvideEmptyParentAlias = ({\n  externalConfig,\n  type,\n  displayProperty,\n}: ExtConfigWithDisplayProp): ExtConfigWithDisplayProp => {\n  externalConfig = shouldHaveType(\n    'parentAlias',\n    { externalConfig, displayProperty, type },\n    'string',\n  );\n\n  if (typeof externalConfig.parentAlias === 'string' && externalConfig.parentAlias.length === 0) {\n    warnAboutEmptyParentAlias(displayProperty);\n    delete externalConfig['parentAlias'];\n  }\n\n  return { externalConfig, displayProperty, type };\n};\n\nconst shouldNotProvideEmptyCustomAttribute = ({\n  externalConfig,\n  type,\n  displayProperty,\n}: ExtConfigWithDisplayProp): ExtConfigWithDisplayProp => {\n  externalConfig = shouldHaveType('attribute', { externalConfig, displayProperty, type }, 'string');\n\n  if (typeof externalConfig.attribute === 'string' && externalConfig.attribute.length === 0) {\n    warnAboutEmptyCustomAttribute(displayProperty);\n    delete externalConfig['attribute'];\n  }\n  return { externalConfig, displayProperty, type };\n};\n\nconst shouldNotProvideNegativeEqAttribute = ({\n  externalConfig,\n  type,\n  displayProperty,\n}: ExtConfigWithDisplayProp): ExtConfigWithDisplayProp => {\n  externalConfig = shouldHaveType('eq', { externalConfig, displayProperty, type }, 'number');\n\n  if (typeof externalConfig.eq === 'number' && externalConfig.eq < 0) {\n    warnAboutNegativeEqAttribute(displayProperty);\n    delete externalConfig['eq'];\n  }\n  return { externalConfig, displayProperty, type };\n};\n\nconst shouldNotProvideNegativeTimeout = ({\n  externalConfig,\n  type,\n  displayProperty,\n}: ExtConfigWithDisplayProp): ExtConfigWithDisplayProp => {\n  externalConfig = shouldHaveType('timeout', { externalConfig, displayProperty, type }, 'number');\n\n  if (typeof externalConfig.timeout === 'number' && externalConfig.timeout < 0) {\n    warnAboutNegativeTimeout(displayProperty);\n    delete externalConfig['timeout'];\n  }\n  return { externalConfig, displayProperty, type };\n};\n\nconst shouldProvideParentDefinedOnlyViaCypressSelectors = ({\n  externalConfig,\n  displayProperty,\n  type,\n}: ExtConfigWithDisplayProp): ExtConfigWithDisplayProp => {\n  if ('parent' in externalConfig) {\n    const { parent } = externalConfig;\n    if (typeof parent === 'undefined' || parent === null) {\n      const typeOfParent = parent === null ? 'null' : 'undefined';\n      throw buildException(\n        [\n          `Selector \\`${displayProperty}\\` defines \"${typeOfParent}\" \"parent\" attribute which is not allowed - there could be 2 reasons why you see this error:`,\n          `1) You've passed \"${typeOfParent}\" to \"parent\" attribute - in that case just remove \"parent\" attribute or assign a proper selector to it`,\n          `2) You've declared parent selector after children selector - due to the way how TypeScript transpiles static class properties, it is not allowed to use static class properties before their declaration.`,\n          `To make this error go away just define \"parent\" before its \"children\".`,\n        ].join('\\n'),\n        'CONFIGURATION ERROR',\n      );\n    }\n  }\n\n  if (externalConfig.parent && typeof externalConfig.parent[internalAliasKey] !== 'string') {\n    warnAboutInvalidParent(displayProperty);\n    delete externalConfig['parent'];\n  }\n  return { externalConfig, displayProperty, type };\n};\n\nconst shouldNotProvideIgnoreCaseForNonTextSelectors = ({\n  externalConfig,\n  displayProperty,\n  type,\n}: ExtConfigWithDisplayProp): ExtConfigWithDisplayProp => {\n  externalConfig = shouldHaveType(\n    'ignoreCase',\n    { externalConfig, displayProperty, type },\n    'boolean',\n  );\n\n  if (\n    typeof externalConfig.ignoreCase === 'boolean' &&\n    SUPPORT_IGNORE_CASE_CONFIGURATION.includes(type) === false\n  ) {\n    warnAboutRedundantIgnoreCaseParam(displayProperty, type);\n    delete externalConfig['ignoreCase'];\n  }\n\n  return { externalConfig, displayProperty, type };\n};\n\nconst shouldNotProvideAttributeConfigForSelectorsThatDoNotSupportIt = ({\n  externalConfig,\n  displayProperty,\n  type,\n}: ExtConfigWithDisplayProp): ExtConfigWithDisplayProp => {\n  if (\n    typeof externalConfig.attribute !== 'undefined' &&\n    SUPPORT_ATTRIBUTE_CONFIGURATION.includes(type) === false\n  ) {\n    warnAboutRedundantAttributeParam(displayProperty, type);\n    delete externalConfig['attribute'];\n  }\n\n  return { externalConfig, displayProperty, type };\n};\n\nconst warnAboutSupplyingParentAndParentAlias = (displayProperty: string): void => {\n  const message = [\n    `Selector \"${displayProperty}\": 'parent' and 'parentAlias' attributes can't be used together in one configuration - 'parent' has precedence over 'parentAlias' so 'parentAlias' is going to be ignored.`,\n    `To fix this warning remove either 'parent' or 'parentAlias' attribute.`,\n  ].join(' ');\n\n  Logger.log(message, 'warning');\n};\n\nconst warnAboutEmptyAlias = (displayProperty: string): void => {\n  const message = `Selector \"${displayProperty}\": 'alias' attribute can't be an empty string. Consider either removing it or supplying non empty string as an alias.`;\n  Logger.log(message, 'warning');\n};\n\nconst warnAboutEmptyParentAlias = (displayProperty: string): void => {\n  const message = `Selector \"${displayProperty}\": 'parentAlias' attribute can't be an empty string. Consider either removing it or supplying non empty string as a parentAlias.`;\n  Logger.log(message, 'warning');\n};\n\nconst warnAboutEmptyCustomAttribute = (displayProperty: string): void => {\n  const message = `Selector \"${displayProperty}\": 'attribute' attribute can't be an empty string. Consider either removing it or supplying non empty string as a custom attribute.`;\n  Logger.log(message, 'error');\n};\n\nconst warnAboutNegativeEqAttribute = (displayProperty: string): void => {\n  const message = `Selector \"${displayProperty}\": 'eq' attribute be a negative value.`;\n  Logger.log(message, 'error');\n};\n\nconst warnAboutNegativeTimeout = (displayProperty: string): void => {\n  const message = `Selector \"${displayProperty}\": 'timeout' attribute can't be a negative value`;\n  Logger.log(message, 'error');\n};\n\nconst warnAboutInvalidParent = (displayProperty: string): void => {\n  const message = `Selector \"${displayProperty}\": the value set as 'parent' is not a valid Selector.`;\n  Logger.log(message, 'error');\n};\n\nconst warnAboutRedundantIgnoreCaseParam = (displayProperty: string, type: SelectorType): void => {\n  const displaySelectorName = mapSelectorTypeToDisplaySelectorName(type);\n  const message = `Selector \"${displayProperty}\": \\`ignoreCase\\` attribute is not supported by \\`${displaySelectorName}\\` selector.`;\n  Logger.log(message, 'warning');\n};\n\nconst warnAboutRedundantAttributeParam = (displayProperty: string, type: SelectorType): void => {\n  const displaySelectorName = mapSelectorTypeToDisplaySelectorName(type);\n  const message = `Selector \"${displayProperty}\": \\`attribute\\` attribute is not supported by \\`${displaySelectorName}\\` selector.`;\n  Logger.log(message, 'warning');\n};\n\nconst warnAboutTypeMismatch = (\n  displayProperty: string,\n  attribute: string,\n  expectedType: string,\n  actualType: string,\n) => {\n  const message = `Selector \"${displayProperty}\": attribute \"${attribute}\" has the wrong type: expected - ${expectedType}, actual - ${actualType}.`;\n  Logger.log(message, 'error');\n};\n\nexport { throwIfNotRunningInCypressEnv, validate, shouldHaveType };\n","/// <reference types=\"cypress\" />\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { fromPairs, toArray } from 'lodash';\nimport { buildException, mapSelectorTypeToDisplaySelectorName } from './utils';\nimport type { SelectorType } from './SelectorBuilder';\n\ntype XPathQueryResult = boolean | string | number | Element;\n\nconst xpath = (\n  subject: any,\n  selector: string,\n  options: Map<string, string | number>,\n  type: SelectorType,\n) => {\n  if (Cypress.dom.isElement(subject) && subject.length > 1) {\n    throw buildException(\n      `Failed to find an element by XPath(\"${selector}\") - the parent is not an element but a collection of ${subject.length} elements.`,\n    );\n  }\n\n  const resolveResult = () =>\n    Cypress.Promise.try(() => evaluateXPath(selector, subject)).then((rawValue) => {\n      const isElements = Array.isArray(rawValue);\n\n      const value = Array.isArray(rawValue)\n        ? Cypress.$(rawValue.values.length === 1 ? rawValue[0] : rawValue)\n        : rawValue;\n\n      if (isElements)\n        value.selector = selector; /* This is to log query in error message in case of failure */\n\n      // @ts-ignore\n      return cy.verifyUpcomingAssertions(value, options, { onRetry: resolveResult });\n    });\n\n  return resolveResult().then((result: XPathQueryResult) => {\n    Cypress.log(generateLogEntryForXPathResult(result, selector, type));\n    return result;\n  });\n};\n\ntype LogEntry = {\n  name: string;\n  consoleProps: () => {\n    'Node Type': string;\n    'XPath Selector': string;\n    'XPath Result': XPathQueryResult;\n  };\n};\nconst generateLogEntryForXPathResult = (\n  result: XPathQueryResult,\n  selector: string,\n  type: SelectorType,\n): LogEntry => {\n  const BASE = { 'XPath Selector': selector, 'XPath Result': result };\n  const name = type === 'xpath' ? `XPath` : `XPath(${mapSelectorTypeToDisplaySelectorName(type)})`;\n\n  if (typeof result !== 'object')\n    return {\n      name,\n      consoleProps: () => ({ ...BASE, 'Node Type': typeof result }),\n    };\n  else {\n    if ('length' in result && 'nodeType' in result === false) {\n      const nodeTypes = toArray<Element>(result)\n        .map((r, id) => `${id}: ${NOTE_TYPE_TO_LABEL_MAPPING[r.nodeType]}`)\n        .join(', ');\n\n      if (result['length'] === 0) BASE['XPath Result'] = 'None';\n\n      return { name, consoleProps: () => ({ ...BASE, 'Node Type': nodeTypes }) };\n    }\n\n    const { nodeType } = result;\n    return {\n      name,\n      consoleProps: () => ({\n        ...BASE,\n        'Node Type': NOTE_TYPE_TO_LABEL_MAPPING[nodeType]\n          ? `${nodeType} - ${NOTE_TYPE_TO_LABEL_MAPPING[nodeType]}`\n          : `${nodeType} - UNKNOWN_NODE_TYPE`,\n      }),\n    };\n  }\n};\n\nconst evaluateXPath = (xpath: string, subject = getDocument()) => {\n  let contextNode;\n  // @ts-ignore\n  const [withinSubject, { document }] = [cy.state('withinSubject'), cy.state('window')];\n\n  if (Cypress.dom.isElement(subject)) contextNode = (subject as any)[0];\n  else if (Cypress.dom.isDocument(subject)) contextNode = subject;\n  else if (withinSubject) contextNode = withinSubject[0];\n  else contextNode = document;\n\n  const result = (contextNode.ownerDocument || contextNode).evaluate(xpath, contextNode);\n\n  if (result.resultType === XPathResult.NUMBER_TYPE) return result.numberValue;\n  else if (result.resultType === XPathResult.STRING_TYPE) return result.stringValue;\n  else if (result.resultType === XPathResult.BOOLEAN_TYPE) return result.booleanValue;\n\n  return collectNodes(result);\n};\n\nconst collectNodes = (nodeIterator: XPathResult): Array<Node> | Node => {\n  const nodes = [];\n  let node = undefined;\n\n  while ((node = nodeIterator.iterateNext())) nodes.push(node);\n  return nodes.length === 1 ? nodes[0] : nodes;\n};\n// @ts-ignore\nconst getDocument = (): Document => cy.state('window').document;\n\n/* Source of types: https://developer.mozilla.org/ru/docs/Web/API/Node/nodeType */\nconst NOTE_TYPE_TO_LABEL_MAPPING = fromPairs([\n  [1, 'ELEMENT_NODE'],\n  [2, 'ATTRIBUTE_NODE'],\n  [3, 'TEXT_NODE'],\n  [4, 'CDATA_SECTION_NODE'],\n  [5, 'ENTITY_REFERENCE_NODE'],\n  [6, 'ENTITY_NODE'],\n  [7, 'PROCESSING_INSTRUCTION_NODE'],\n  [8, 'COMMENT_NODE'],\n  [9, 'DOCUMENT_NODE'],\n  [10, 'DOCUMENT_TYPE_NODE'],\n  [11, 'DOCUMENT_FRAGMENT_NODE'],\n  [12, 'NOTATION_NODE'],\n]);\n\nconst registerInternalXPathCommand = (): void =>\n  Cypress.Commands.add(\n    '__cypress_selectors_xpath',\n    { prevSubject: ['optional', 'element', 'document'] },\n    xpath,\n  );\n\nexport { registerInternalXPathCommand, generateLogEntryForXPathResult };\n","/* eslint-disable @typescript-eslint/no-namespace */\n/// <reference types=\"cypress\" />\n\nimport { pick } from 'lodash';\n\nimport { buildSelector } from './SelectorBuilder';\nimport { internalAliasKey } from './InternalSymbols';\nimport { throwIfNotRunningInCypressEnv, validate } from './Validators';\nimport {\n  getHostIdFromHost,\n  registerAndAssignNewHostId,\n  makeInternalAlias,\n  makeDisplayPropName,\n} from './utils';\n\nimport { registerInternalXPathCommand } from './XPath';\nregisterInternalXPathCommand();\n\nimport type {\n  Host,\n  SelectorType,\n  SelectorMeta,\n  EnvWithSelectorsStorage,\n  InternalSelectorConfig,\n  SelectorsEngine,\n} from './SelectorBuilder';\n\ninterface Selector extends Cypress.Chainable {\n  [internalAliasKey]: string;\n}\ntype Chainable = Cypress.Chainable;\n\nexport type ExternalSelectorConfig = {\n  alias?: string;\n  parentAlias?: string;\n  attribute?: string;\n  eq?: number;\n  timeout?: number;\n  parent?: Selector;\n  ignoreCase?: boolean;\n};\n\nconst BuildSelectorBy = (type: SelectorType, engine: SelectorsEngine) => (\n  value: string,\n  externalConfig: ExternalSelectorConfig = {},\n) => {\n  throwIfNotRunningInCypressEnv();\n\n  const configAttributes = [\n    'alias',\n    'parentAlias',\n    'attribute',\n    'eq',\n    'timeout',\n    'parent',\n    'ignoreCase',\n  ];\n  const safeConfig: ExternalSelectorConfig = pick(externalConfig, configAttributes);\n\n  return (host: Host, property: string) => {\n    const displayPropName = makeDisplayPropName(host, property);\n    const selectorConfig = { ...validate(safeConfig, displayPropName, type), value, type };\n    const hostID =\n      getHostIdFromHost(host) ??\n      registerAndAssignNewHostId((cy as unknown) as EnvWithSelectorsStorage, host);\n\n    const internalAlias = makeInternalAlias(hostID, property);\n    const internalParentAlias = selectorConfig.parent && selectorConfig.parent[internalAliasKey];\n\n    const config: InternalSelectorConfig = { ...selectorConfig, internalAlias };\n    if (internalParentAlias) config.internalParentAlias = internalParentAlias;\n\n    const meta: SelectorMeta = { host, property, hostID };\n\n    return buildSelector({ type, config, meta, engine }, cy);\n  };\n};\n\nconst ByAttribute = BuildSelectorBy('attribute', 'CSS');\nconst ByType = BuildSelectorBy('type', 'CSS');\nconst ByClass = BuildSelectorBy('class', 'CSS');\nconst ById = BuildSelectorBy('id', 'CSS');\nconst BySelector = BuildSelectorBy('selector', 'CSS');\nconst ByName = BuildSelectorBy('name', 'CSS');\nconst ByXPath = BuildSelectorBy('xpath', 'XPath');\nconst ByExactText = BuildSelectorBy('exact-text', 'XPath');\nconst ByPartialText = BuildSelectorBy('partial-text', 'XPath');\nconst ByExactLinkText = BuildSelectorBy('exact-link-text', 'XPath');\nconst ByPartialLinkText = BuildSelectorBy('partial-link-text', 'XPath');\n\nconst By = {\n  Attribute: ByAttribute,\n  Type: ByType,\n  Class: ByClass,\n  Id: ById,\n  Selector: BySelector,\n  XPath: ByXPath,\n  Name: ByName,\n  Text: {\n    Exact: ByExactText,\n    Partial: ByPartialText,\n  },\n  Link: {\n    ExactText: ByExactLinkText,\n    PartialText: ByPartialLinkText,\n  },\n};\n\nexport {\n  By,\n  ByAttribute,\n  ByType,\n  ByClass,\n  ById,\n  BySelector,\n  ByXPath,\n  ByExactText,\n  ByPartialText,\n  ByName,\n  ByExactLinkText,\n  ByPartialLinkText,\n};\nexport type { Selector, Chainable };\n"],"names":["Logger","LOG_PREFIX","logSelector","selector","propertyPath","level","log","appendLogPrefix","message","formattedMsg","console","info","warn","error","internalAliasKey","Symbol","hostIDKey","byExternalAlias","byInternalAlias","buildException","kind","Error","isConfigurableProperty","host","name","descriptor","Object","getOwnPropertyDescriptor","Boolean","configurable","makeDisplayPropName","property","makeInternalAlias","hostID","alias","registerAndAssignNewHostId","env","getHostIdFromHost","TRANSLATE_TO_LOWER_CASE_XPATH_FN","escapeQuoteSymbols","query","escaped","flatMap","inclusiveSplitByDoubleQuote","inclusiveSplitBySingleQuote","inclusiveSplitByBackTick","map","wrapQuoteSymbol","length","join","w","split","symbol","mapSelectorTypeToDisplaySelectorName","type","DEFAULT_ATTRIBUTE","DEFAULT_LOGGING","DEFAULT_SEARCH_ONLY_FIRST_LEVEL_DESCENDANTS","DEFAULT_CONFIG","defaultAttribute","isLoggingEnabled","searchOnlyFirstLevelDescendants","CONFIG_HANDLER","reset","config","configure","ConfigureSelectors","ResetSelectorsConfiguration","getConfiguration","buildSelector","meta","registerStoragesAndSelector","selectorsByInternalAlias","elementGetter","generateElementGetter","selectorProxy","generateSelectorProxy","assignInternalAliasToProxy","internalAlias","enumerable","value","defineProperty","displayProp","getChainer","proxyAccessHandler","proxy","field","chainer","bind","Proxy","get","registerSelectorsByInternalAliasStorageIfNotRegistered","registerSelectorByInternalAlias","selectorsByExternalAlias","registerSelectorByExternalAliasStorageIfNotRegistered","registerSelectorByExternalAlias","hasSelectorsStorage","Map","hasOwnProperty","storage","has","set","getStorageOfExternalAliases","configuration","mapSelectorByType","chainOfSelectors","collectSelectorsChain","mapSelectorConfigsToSelectorsChain","selectorsChain","parentAlias","internalParentAlias","nextSelector","getSelectorByAliasOrThrow","ANY_LEVEL_DESCENDANT","FIRST_LEVEL_DESCENDANT","mapSelectorConfigsToSelectorString","selectors","mappedSelectors","mapSelectorToString","descendance","mapSelectorsByType","groupSelectorsByEngineSequentially","reduce","chain","index","options","timeout","engine","eq","__cypress_selectors_xpath","isFirstInChain","find","cy","groupedByEngine","group","Cypress","defaultCommandTimeout","getMaxTimeout","max","result","chunk","push","stringifiedSelector","attribute","mapExactTextSelector","mapPartialTextSelector","forTag","prefix","hasParent","ignoreCase","toLowerCase","undefined","SUPPORT_IGNORE_CASE_CONFIGURATION","SUPPORT_ATTRIBUTE_CONFIGURATION","throwIfNotRunningInCypressEnv","validate","externalConfig","displayProperty","flow","shouldNotProvideBothParentAndParentAlias","shouldNotProvideEmptyAlias","shouldNotProvideEmptyParentAlias","shouldNotProvideEmptyCustomAttribute","shouldNotProvideNegativeEqAttribute","shouldNotProvideNegativeTimeout","shouldProvideParentDefinedOnlyViaCypressSelectors","shouldNotProvideIgnoreCaseForNonTextSelectors","shouldNotProvideAttributeConfigForSelectorsThatDoNotSupportIt","sanitizedConfig","shouldHaveType","expectedType","actualType","warnAboutTypeMismatch","parent","warnAboutSupplyingParentAndParentAlias","warnAboutEmptyAlias","warnAboutEmptyParentAlias","warnAboutEmptyCustomAttribute","warnAboutNegativeEqAttribute","warnAboutNegativeTimeout","typeOfParent","warnAboutInvalidParent","includes","warnAboutRedundantIgnoreCaseParam","warnAboutRedundantAttributeParam","displaySelectorName","xpath","subject","dom","isElement","resolveResult","Promise","evaluateXPath","then","rawValue","isElements","Array","isArray","$","values","verifyUpcomingAssertions","onRetry","generateLogEntryForXPathResult","BASE","consoleProps","nodeTypes","toArray","r","id","NOTE_TYPE_TO_LABEL_MAPPING","nodeType","getDocument","contextNode","state","withinSubject","document","isDocument","ownerDocument","evaluate","resultType","XPathResult","NUMBER_TYPE","numberValue","STRING_TYPE","stringValue","BOOLEAN_TYPE","booleanValue","collectNodes","nodeIterator","nodes","node","iterateNext","fromPairs","registerInternalXPathCommand","Commands","add","prevSubject","BuildSelectorBy","configAttributes","safeConfig","pick","displayPropName","selectorConfig","ByAttribute","ByType","ByClass","ById","BySelector","ByName","ByXPath","ByExactText","ByPartialText","ByExactLinkText","ByPartialLinkText","By","Attribute","Type","Class","Id","Selector","XPath","Name","Text","Exact","Partial","Link","ExactText","PartialText"],"mappings":"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"}